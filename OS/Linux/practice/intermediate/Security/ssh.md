# ssh: Secure Shell

<details> <summary> basic </summary>

### about

>https://zah.uni-heidelberg.de/it-guide/ssh-tutorial-linux
- secure protocol used as the primary means of connecting to linux servers remotely.
- stands for Secure Shell and provides a safe and secure way of executing commands, making changes, and configuring services remotely.
- When connect through SSH, we log in using an account that exists on the remote server.
- ssh uses the client-server model.


### How SSH works

- When we connect through SSH, we will be dropped into a shell session, which is a text-based interface where you can interact with your server.
- During on our SSH session, any commands that we type into our terminal are sent through an encrypted SSH tunnel and executed on our server.
- SSH connection is implemented using a client-server model.
- This means that for an SSH connection to be established, the remote machine must be running a piece of software called an SSH daemon.
- This software listens for connections on a specific network port, authenticates connection requests, and spawns the appropriate environment if the user provides the correct credentials.
- The user's computer must have an SSH client that have function to communicate using the SSH protocol and can be given information about the remote host to connect to, username to use and credential should pass to authenticate.

### SSH Authenticates User

- Client generally authenticate with passwords or SSH keys(*recommended). 
- SSH keys are a matching set of cryptographic keys which can be used for authentication, each set contains a public and a private key.
- The public key can be shared freely without concern, while private key must be vigilantly guarded

### SSH Code generate

\# Remote server side

public key must be copied on a file: ~/.ssh/authorized_keys

\# Client side

- must have SSH key pair on their local computer

### SSH sequence

\# logic 

1. When a client connects to the host, wishing to use SSH key authentication
2. This will inform the server of this intent and will tell the server which 'public key' to use.
3. The server then check its 'authorized_keys' file for public key, generate a random string and encrypts it using the public key.
4. This enrypted message can only be decrypted with the associated private key.
5. The server will send this encrypted message to the client to test whether they have private key.
6. upon receipt of this message, the client decrypt it using the private key and combine the random string that is revealed with a previously negotiated session ID. 
7. It then generates an MD5 hash of this value and transmits it back to the server.
8. After receipt message on server, then compare an MD5 hash generated by those values and determine that the client must have the private key.

\# practical

1. generating an SSH key Pair: ssh-keygen
2. add the public key on remote machine: ~/.ssh/authorized_keys


### file

- ~/.ssh/id_rsa     : The private key.
- ~/.ssh/id_rsa.pub : The associated public key. share freely

### cmd

- ssh-keygen: make securekey
- ssh-keygen -p: change or remove Private key. Change key cycle is similar with change password. (type original key and type new key two times.)
- ssh-keygen -l: Displaying the SSH key fingerprint. Showing about key length, the fingerprint, and account and algorithm used.
- ssh [remote_host]: Connecting to a Remote Server adress: remote_host
- ssh -L [port:hostaddress:port]: port forwading


### concept

<img src="../public/a03_ssh-01.png" style="width:700px">


### example

1. login sequence

why: to avoid firewall block. This called tunneling.

```
# app1
ssh -p 1111 root@192.168.75.13
# app2
setting local port forwarding as 127.0.0.1:2022 to localhost:2002
ssh -p 3333 -L 1111:127.0.0.1:3333 root@192.168.73.5
```

### configure

- systemctl status ssh      : ssh service check, run or not
- vim /etc/ssh/sshd_config  : can find about sshd_config

</details>

<details> <summary> usage </summary>

### Interact with remote machine

\# code

1. ssh [hostmachine] [command]

ex) ssh -p 22 192.168.50.176 'hostname'


2. ssh [hostmachine] | tee [file]

- This command input whole activity in ssh process.
ex) ssh -p 22 192.168.50.176 | tee stdout.txt

</details>