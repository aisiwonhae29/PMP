# TLS: Transport Layer Security

### about

- A TLS is a widely adopted security protocol designed to facilitate privacy and data security for communications over the internet.
- A primary use case of TLS is encrypting the communication between web app and servers, such as web browsers loading a website.
- TLS can also be used to encrypt other communications such as email, messaging, and voice over IP (VoIP)
- TLS was developed by SSL, so the terms are sometimes used interchangeably.
- HTTPS is an inplementation of TLS encryption on top of the HTTP protocol, which is used by all websites as well as some other web services.

### key

- Encryption        : Hides the data being transferred from third parties.
- Authentication    : Ensures that the parties exchanging information are who they clam to be.
- Integrity         : Verifies that the data has not been forged or tampered with.

### concept

\# TLS certificate

- For a website or application to use TLS, it must have a TLS certificate installed on its origin server(certificate is also known as SSL cert).
- A TLS certificate is issued by a cert authority to the person or business that owns a domain.
- The cert contains important info about who owns the domain, along with the server's public key, both of which are important for validating the server's identity.

\# cipher suit

- The TLS handshake establishes a cipher suite for each communication session.
- This is a set of algorithms that specifies details such as which shared encryption keys, or session keys, will be used for that particular session.
- TLS is able to set the matching session keys over an unencrypted channel thanks to a technology known as public key cryptography.

### logic

- A TLS connection is initiated using a sequence known as the TLS handshake.
- when a user navigates to a website, the TLS handshake begins between the user's device and web server.
  - During handshakes
    - Specify which version of TLS (1.0, 1.2, 1.3, etc) they will use
    - Decide on which cipher suites they will use
    - Authenticate the identity of the server using the server's TLS cert.
    - Generate session keys for encrypting msg between them after the handshake is complete.
- Usually used in public key, means one way key each key encrypt decrypt sequencially.

### sequence: TLS handshakes

\# meta info

- TLS handshakes are a series of datagrams, or msg, exchanged by a client and a server.
- the exact steps within a TLS handshake will vary depending upon the kind of key exchange algorithm used and the cipher suites supported by both sides.

\# initiating spot

- Whenever a user navigates to a website over HTTPS and the browser first begins to query the website's origin server.
- Initiated using communications with HTTPS, including API calls and DNS over HTTPS queries.
- etc) TLS handshakes occur after a TCP connection has been opened via a TCP handshake.

\# ordered event: negotiate

<img src='../../../zzz_image/Security_TLS.png' style='height: 500px'>

1. The 'client hello' msg
  
- The client initiates the handshake by sending a 'hello' msg to the server.
- The msg will include which TLS version the client supports, the cipher suites supported, and a string of random bytes known as the 'client random'

2. The 'server hello' msg

- In reply to the client hello msg, the server sends a msg containing the server's SSL certificate, the server's chosen cipher suite, and the 'server random', another random string of bytes that's generated by the server.

3. Authentication

- The client verifies the server's SSL certificate with the certificate wuthority that issued it.
- This confirms that the server is who it says it is, and that the client is interacting with the actual owner of the domain.

4. The premaster secret

- The client sends one more random string of bytes, the 'premaster secret'.
- The premaster secret is encrypted with the public key and can only be decrypted with the private key by the server.

5. Private key used

- The server decrypts the premaster secret

6. Session keys created

- Both client and server generate session keys from the client random, the server random, and the premaster secret
- They should arrive at the same results
  - KDF: Key Derivation Function, responsible on deriving session keys from the shared secret info during TLS handshake.
  - Each parties makes own session keys, and after end of session the session key is discarded.

7. Client is ready

- The client sends a 'finished' msg that is encrypted with a session key.

8. Server is ready

- The server sends a 'finished' msg encrypted with a session key.

9. Secure symmetric encryption achieved

- The handshake is completed, and communication continues using the session keys.

## java case

